saveplot='OFF';

% load('./RelicNuBkg/Refs/RefsFromHeizmannPhD.mat');
% load('./RelicNuBkg/SensVsMnuSq_KNM1_[0_4].mat');
% eta=Sensitivities;
% mnuSq=sqrt(ScanPoints);
% load('./RelicNuBkg/SensVsMnuSq_TDR_[0_4]_Syst.mat');
% Faes13     = importdata('RelicNuBkg/Refs/Fäs13.txt');
% LVV08lower = importdata('RelicNuBkg/Refs/LVV08lower.txt');
% LVV08upper = importdata('RelicNuBkg/Refs/LVV08upper.txt');
% RW04lower  = importdata('RelicNuBkg/Refs/RW04lower.txt');
% RW04upper  = importdata('RelicNuBkg/Refs/RW04upper.txt');
% HM05  = [HM05 HM05];
% KFM10 = [KFM10 KFM10];
% Lob99 = [Lob99 Lob99];
% Rob91 = [Rob91 Rob91];
% %area(linspace(-sqrt(2),2,2),Lob99,1e16,'FaceColor',[0 0.75 0.75]);
% fig1=figure('Renderer','painters');
% set(fig1, 'Units', 'normalized', 'Position', [0.001, 0.001, 0.6, 0.6]);
% hold on;
% area(linspace(-sqrt(2),2,2),HM05,1e16,'FaceColor',[0 0.75 0.75]);
% area(linspace(-sqrt(2),2,2),Rob91,'FaceColor',[0 0.5 0.5]);
% plot(mnuSq,eta,'LineWidth',3,'Color','red');
% plot(sqrt(ScanPoints),Sensitivities,'LineWidth',3,'Color','red','LineStyle',':');
% plot(linspace(-sqrt(2),2,2),KFM10,'LineWidth',2,'Color',[0.9290 0.6940 0.1250]);
% plot(Faes13(:,1),Faes13(:,2),'LineWidth',2,'LineStyle','--');
% plot(LVV08lower(:,1),LVV08lower(:,2));
% plot(LVV08upper(:,1),LVV08upper(:,2));
% x = [LVV08lower(:,1)', fliplr(LVV08upper(:,1)')];
% inBetween = [LVV08lower(:,2)', fliplr(LVV08upper(:,2)')];
% fill(x, inBetween, [1 1 0]);
% plot(RW04lower(:,1),RW04lower(:,2));
% plot(RW04upper(:,1),RW04upper(:,2));
% x = [RW04lower(:,1)', fliplr(RW04upper(:,1)')];
% inBetween = [RW04lower(:,2)', fliplr(RW04upper(:,2)')];
% fill(x, inBetween, [0 1 0]);
% ax=gca;
% ax.YScale='log';
% grid on;
% ax.Layer='bottom';
% text(0.1,1e15,'Robertson et al.','FontSize',14);
% text(0.8,5e13,'Hwang et al., Lobashev et al.','FontSize',14);
% %text(1.6,1e12,'Lobashev et al.','FontSize',14);
% text(1,5e11,'KRN1 Twins','FontSize',14,'FontWeight','bold');
% text(0.6,3e10,'KATRIN Sensitivity limit (Bkg rate 130 mcps)','FontSize',14,'FontWeight','bold');
% text(0.1,1e9,'Kaboth et al.: KATRIN sensitivity limit (design Bkg)','FontSize',14);
% text(1.3,7e6,'Fässler et al.','FontSize',14);
% text(1,5e3,'Lazauskas et al.','FontSize',14);
% text(1,10,sprintf('Ringwald & Wong \n (extrapolated)'),'FontSize',14);
% xlabel('m_{\nu} (eV)');
% ylabel('\eta (90% C.L.)');
% xlim([0 2]);
% PrettyFigureFormat;
% hold off;
% 
% fig1a=figure('Renderer','painters');
% set(fig1a, 'Units', 'normalized', 'Position', [0.001, 0.001, 0.6, 0.6]);
% hold on;
% area(linspace(-sqrt(2),2,2),HM05,1e16,'FaceColor',[0 0.75 0.75]);
% area(linspace(-sqrt(2),2,2),Rob91,'FaceColor',[0 0.5 0.5]);
% plot(mnuSq,eta,'LineWidth',3,'Color','red');
% plot(linspace(-sqrt(2),2,2),KFM10,'LineWidth',2,'Color',[0.9290 0.6940 0.1250]);
% plot(Faes13(:,1),Faes13(:,2),'LineWidth',2,'LineStyle','--');
% plot(LVV08lower(:,1),LVV08lower(:,2));
% plot(LVV08upper(:,1),LVV08upper(:,2));
% x = [LVV08lower(:,1)', fliplr(LVV08upper(:,1)')];
% inBetween = [LVV08lower(:,2)', fliplr(LVV08upper(:,2)')];
% fill(x, inBetween, [1 1 0]);
% plot(RW04lower(:,1),RW04lower(:,2));
% plot(RW04upper(:,1),RW04upper(:,2));
% x = [RW04lower(:,1)', fliplr(RW04upper(:,1)')];
% inBetween = [RW04lower(:,2)', fliplr(RW04upper(:,2)')];
% fill(x, inBetween, [0 1 0]);
% ax=gca;
% ax.YScale='log';
% grid on;
% ax.Layer='bottom';
% text(0.1,1e15,'Robertson et al.','FontSize',14);
% text(0.8,5e13,'Hwang et al., Lobashev et al.','FontSize',14);
% %text(1.6,1e12,'Lobashev et al.','FontSize',14);
% text(1,5e11,'KRN1 Twins','FontSize',14,'FontWeight','bold');
% text(0.1,1e9,'Kaboth et al.: KATRIN sensitivity limit (design Bkg)','FontSize',14);
% text(1.3,7e6,'Fässler et al.','FontSize',14);
% text(1,5e3,'Lazauskas et al.','FontSize',14);
% text(1,10,sprintf('Ringwald & Wong \n (extrapolated)'),'FontSize',14);
% xlabel('m_{\nu} (eV)');
% ylabel('\eta (90% C.L.)');
% xlim([0 2]);
% PrettyFigureFormat;
% hold off;
% 
% A=ref_RelicNuBkg_DesignReport('ToggleES','ON','eta_i',2e9);
% B=ref_RelicNuBkg_DesignReport('ToggleES','OFF','eta_i',2e9);
% A.ComputeTBDDS;B.ComputeTBDDS;A.ComputeTBDIS;B.ComputeTBDIS;
% fig2=figure('Renderer','painters');
% set(fig2, 'Units', 'normalized', 'Position', [0.001, 0.001,0.45, 0.45]);
% semilogy(A.qU-A.Q,A.TBDIS_R./(A.TBDIS-A.TBDIS_R),'LineWidth',2);
% hold on;
% semilogy(B.qU-B.Q,B.TBDIS_R./(B.TBDIS-B.TBDIS_R),'LineWidth',2);
% xlabel('E-E_0 (eV)');
% ylabel('n_{C\nuB}/n_\beta (integral)');
% legend('Full C\nuB int spec','Ground state only','box','off','location','northwest');
% ylim([5e-7 1e-2]);
% xlim([-50 inf]);
% x1=[0.55 0.775];
% y1=[0.6 0.8];
% str1={'Ground state:','~1e-2 at sensitivity limit,','barely detectable'};
% a=annotation('textarrow',x1,y1,'String',str1);
% a.FontSize=16;
% x2=[0.45 0.2];
% y2=[0.25 0.24];
% str2={'Excited states:','~1e-6, undetectable'};
% b=annotation('textarrow',x2,y2,'String',str2);
% b.FontSize=16;
% PrettyFigureFormat;
% hold off;
% 
% fig3=figure('Renderer','painters');
% set(fig3, 'Units', 'normalized', 'Position', [0.001, 0.001,0.45, 0.45]);
% semilogy(A.Te-A.Q,A.TBDDS_R,'LineWidth',2);
% hold on;
% plot(B.Te-B.Q,B.TBDDS_R,'LineWidth',2);
% xlabel('E-E_0 (eV)');
% ylabel('Rate per 0.1 eV (cps)');
% xlim([-30 inf]);
% ylim([1e-6 2e-4]);
% legend('Full C\nuB diff spec','Gaussian fit of ground state','box','off','location','northwest');
% PrettyFigureFormat;
% hold off;
% 
% fig4=figure('Renderer','painters');
% set(fig4, 'Units', 'normalized', 'Position', [0.001, 0.001,0.45, 0.5]);
% A=ref_RelicNuBkg_KNM1('TTFSD','OFF','HTFSD','OFF','DTFSD','OFF','mnuSq_i',2);
% B=ref_RelicNuBkg_KNM1('mnuSq_i',2);
% A.ComputeTBDDS;B.ComputeTBDDS;
% a=semilogy(A.Te-A.Q,A.TBDDS,'LineWidth',2);
% hold on;
% b=semilogy(A.Te-A.Q,A.TBDDS_R,'LineWidth',2);
% c=semilogy(B.Te-B.Q,B.TBDDS-B.TBDDS_R,'LineWidth',2);
% d=semilogy(B.Te-B.Q,B.TBDDS_R,'LineWidth',2);
% ylabel('Rate per Energy Bin (arb. units)');
% xlabel('Energy - E_{0} (eV)');
% legend([a b c d],'\beta decay, P_{f}(E)=\delta(0)','C\nuB, P_{f}(E)=\delta(0)','\beta decay, standard FSD','C\nuB, standard FSD');
% legend boxoff;
% xlim([-6 4]);
% ylim([1e-10 1e14]);
% x1=[0.705 0.705];
% y1=[0.6 0.15];
% a=annotation('line',x1,y1);
% a.LineStyle='--';
% a.LineWidth=2;
% a.Color=[0.5 0.5 0.5];
% x2=[0.571 0.571];
% y2=[0.6 0.4];
% b=annotation('line',x2,y2);
% b.LineStyle='--';
% b.LineWidth=2;
% b.Color=[0.5 0.5 0.5];
% x3=[0.62 0.705];
% y3=[0.3 0.3];
% c=annotation('textarrow',x3,y3,'String','2m_\nu');
% c.FontSize=16;
% x4=[0.57 0.483];
% y4=[0.3 0.3];
% d=annotation('arrow',x4,y4);
% x5=[0.665 0.705];
% y5=[0.55 0.55];
% e=annotation('textarrow',x5,y5,'String','E_{GS}');
% e.FontSize=16;
% x6=[0.615 0.571];
% y6=[0.55 0.55];
% f=annotation('arrow',x6,y6);
% PrettyFigureFormat;
% hold off;
% 
% % relic_global('range',30,'annotations','ON','saveplot','ON');
% % 
% % PlotBestFit('DataType','Twin','saveplot','ON');
% % PlotBestFit('DataType','Twin','Nfit',1000,'saveplot','ON');
% % PlotBestFit('DataType','Real','saveplot','ON');
% % 
% RelicSystematics('ON','Fake');
% RelicSystematics('ON','Twin');
% RelicSystematics('ON','real');
% 
% fig5=figure('Renderer','painters');
% set(fig5, 'Units', 'normalized', 'Position', [0.001, 0.001,0.35, 0.45]);
% load('./RelicNuBkg/UpperLimits/EtaFit_mNu0_1_SystON_DataTypeTwinSinglemnuSq_TwinBias_mnuSq0_E0 Norm Bkg eta.mat');
% [a,b] = boundedline(sqrt(mNu),etaFit,eta);
% ylim([0 3.4e11]);
% xlim([0 1]);
% xlabel('m_{\nu} (eV)');
% ylabel('\eta');
% legend([a b],'\eta best fit','90% C.L.','box','off','location','northwest');
% PrettyFigureFormat;
% 
% fig6=figure('Renderer','painters');
% set(fig6, 'Units', 'normalized', 'Position', [0.001, 0.001,0.45, 0.6]);
% load('./RelicNuBkg/Chi2Scans/RelicChi2Scan_Twin_BiasmnuSq0_SystON_range40_KNM1_2D.mat');
% [n,t]=contour(mnuScanPoints,etaScanPoints,Chi2',[0 4.61]);
% t.LineWidth=2;
% xlabel('m_\nu^2 (eV^2)');
% ylabel('\eta');
% xlim([0 2.3]);
% ylim([0 inf]);
% hold on;
% h=fill(n(1,2:end),n(2,2:end),[50 148 216]/255);
% h.FaceAlpha=0.2;
% a=annotation('textarrow',[0.2 0.13],[0.2 0.13],'String','(\eta_{true},m_{\nu,true}^2)=(0,0)');
% a.FontSize=16;
% str={'90% C.L. contour','(\Delta\chi^2=4.61)'};
% b=annotation('textarrow',[0.67 0.7],[0.65 0.84],'String',str);
% b.FontSize=16;
% c=annotation('line',[0.536 0.536],[0.15 0.9]);
% c.LineWidth=2;
% c.LineStyle='--';
% c.Color=[0.5 0.5 0.5];
% text(1.15,1.5e11,'KNM1','FontWeight','bold','FontSize',20,'Rotation',90,'Color',[0.5 0.5 0.5]);
% [~,u]=contour(mnuScanPoints(1:22),etaScanPoints,Chi2(1:22,:)',[0 4.61]);
% u.LineWidth=4;
% u.Color=[0.8500 0.3250 0.0980];
% d=annotation('textarrow',[0.3 0.3],[0.6 0.79],'String','\eta limit (90% C.L.)');
% d.FontSize=16;
% PrettyFigureFormat;
% hold off;
% 
% fig7=figure('Renderer','painters');
% set(fig7, 'Units', 'normalized', 'Position', [0.001, 0.001,0.35, 0.45]);
% load('./RelicNuBkg/UpperLimits/EtaFit_mNu0_1_SystON_DataTypeRealSinglemnuSq_TwinBias_mnuSq0_E0 Norm Bkg etaDeltaChi2_1.mat');
% eta90=eta;
% etaFit90=etaFit;
% load('./RelicNuBkg/UpperLimits/EtaFit_mNu0_1_SystON_DataTypeRealSinglemnuSq_TwinBias_mnuSq0_E0 Norm Bkg etaDeltaChi2_4.mat');
% eta95=eta;
% etaFit95=etaFit;
% load('./RelicNuBkg/UpperLimits/EtaFit_mNu0_1_SystON_DataTypeRealSinglemnuSq_TwinBias_mnuSq0_E0 Norm Bkg etaDeltaChi2_9.mat');
% hold on;
% [~,b] = boundedline(sqrt(mNu),etaFit90,eta90,'cmap',[0 0.75 0.75]);
% [~,d] = boundedline(sqrt(mNu),etaFit95,eta95,'cmap',[0 0.5 0.5],'alpha');
% [~,f] = boundedline(sqrt(mNu),etaFit,eta,'cmap',[0 0.25 0.25],'alpha');
% text(0.1,3.3e11,'1\sigma C.L.','FontSize',14);
% text(0.4,5e11,'2\sigma C.L.','FontSize',14);
% text(0.7,6.5e11,'3\sigma C.L.','FontSize',14);
% ylim([0 inf]);
% xlabel('m_{\nu} (eV)');
% ylabel('\eta');
% a=annotation('textarrow',[0.6 0.5],[0.38 0.455],'String','\eta best fit');
% a.FontSize=16;
% PrettyFigureFormat;
% hold off;
% 
% fig8=figure('Renderer','painters');
% set(fig8, 'Units', 'normalized', 'Position', [0.001, 0.001,0.45, 0.6]);
% load('./RelicNuBkg/Chi2Scans/RelicChi2Scan_Twin_BiasmnuSq0_SystON_range40_KNM1_2D_Real.mat');
% hold on;
% [q,t]=contour(mnuScanPoints,etaScanPoints,(Chi2-GlobalChi2Min).',[0 4.61]);
% t.LineWidth = 2;
% [r,u]=contour(mnuScanPoints,etaScanPoints,(Chi2-GlobalChi2Min).',[0 5.99]);
% u.LineWidth = 2;
% [s,v]=contour(mnuScanPoints,etaScanPoints,(Chi2-GlobalChi2Min).',[0 9.21]);
% v.LineWidth = 2;
% v.Color=[0 0.8 0.8];
% [~,w]=contour(mnuScanPoints(10:end),etaScanPoints,(Chi2(10:end,:)-GlobalChi2Min).',[0 9.21]);
% w.LineWidth=4;
% w.Color=[0 0.5 0.5];
% ylabel('\eta','FontSize',12);
% xlabel('m_{\nu}^{2} (eV^{2})','FontSize',12);
% zlabel('\Delta\chi^2','FontSize',12);
% text(0.4,5.5e11,'90% C.L.','FontSize',14,'Rotation',12);
% text(0.4,6.1e11,'95% C.L.','FontSize',14,'Rotation',12);
% text(0.4,6.7e11,'99% C.L.','FontSize',14,'Rotation',12);
% xlim([-1,1]);
% ylim([0,8e11]);
% %s(1,32)=-1.5;s(2,32)=-2e11;s(1,1)=3;s(2,1)=-8e11;
% s(1,1)=3.2;s(1,38)=-3.2;
% j=fill(s(1,:),s(2,:),[0 0.5 0.5],'FaceAlpha',0.2);
% i=fill(r(1,2:end),r(2,2:end),[0 1 1],'FaceAlpha',0.2);
% h=fill(q(1,2:end),q(2,2:end),[50 148 216]/255,'FaceAlpha',0.2);
% a=annotation('rectangle',[0.13 0.13 0.388 0.795],'FaceColor','magenta','FaceAlpha',.2);
% text(-0.8,4.5e11,{'Unphysical','neutrino mass'},'FontSize',20,'Color','red','Rotation',-30);
% b=annotation('line',[0.845 0.845],[0.13 0.88]);
% b.LineWidth=2;
% b.Color=[0 0 1];
% c=annotation('line',[0.535 0.535],[0.13 0.77]);
% c.LineWidth=2;
% c.Color=[0 0 1];
% text(0.9,4e11,'KNM2','FontSize',16,'Rotation',90,'Color',[0 0 1]);
% text(0.1,1.3e11,'cosmology','FontSize',16,'Rotation',90,'Color',[0 0 1]);
% text(0.79,3.68e11,'X','FontWeight','bold','FontSize',16,'Rotation',90);
% d=annotation('textarrow',[0.76 0.82],[0.4 0.5],'String','Global best fit');
% d.FontSize=16;
% e=annotation('textarrow',[0.5 0.6],[0.85 0.8],'String','\eta limit (99% C.L.)');
% e.FontSize=16;
% PrettyFigureFormat;
% hold off;
% 
% load('./RelicNuBkg/Chi2Scans/RelicChi2Scan_Twin_BiasmnuSq0_SystON_range40_KNM1_[0 3e+11]_mNu E0 Norm Bkg_relicPeakPos_0.mat');
% eta=(0:(Netabins-1))*((etafactor*10^(etarange))/(Netabins-1));
% fig9=figure('Renderer','painters');
% set(fig9, 'Units', 'normalized', 'Position', [0.001, 0.001,0.4, 0.55]);
% plot(eta,Chi2,'LineWidth',2);
% xlabel('\eta','FontSize',12);
% ylabel('\chi^2','FontSize',12);
% a=annotation('line',[0.885 0.885],[0.1 0.9]);
% a.LineWidth=2;
% a.LineStyle='--';
% a.Color=[0.5 0.5 0.5];
% b=annotation('line',[0.1 0.9],[0.845 0.845]);
% b.LineWidth=2;
% b.LineStyle='--';
% b.Color=[0.5 0.5 0.5];
% PrettyFigureFormat;
% 
% load('KNM1_RelicOpt2.mat');
% load('KNM1_40.mat');
% fig10=figure('Renderer','painters');
% set(fig10, 'Units', 'normalized', 'Position', [0.001, 0.001,0.5, 0.35]);
% bar(qU-18573.73,qUfrac);
% hold on;
% bar(MTD_opt.qU-18573.73,MTD_opt.qUfrac,'FaceAlpha',0.7);
% xlim([-20 50]);
% xlabel('qU-E_0 (eV)');
% ylabel('Time fraction');
% legend('KRN1 MTD','Proposed optimization','box','off');
% annotation('line',[0.333 0.333],[0.2 0.9],'LineWidth',2,'LineStyle','--');
% annotation('line',[0.3545 0.3545],[0.2 0.9],'LineWidth',2,'LineStyle','--');
% PrettyFigureFormat;
% hold off;
% 
% load('./RelicNuBkg/SensVsMnuSq_KNM1_[0_4].mat');
% eta=Sensitivities;
% mnuSq=ScanPoints;
% load('./RelicNuBkg/SensVsmnuSq_KNM1_[1_4]_opt.mat');
% fig11=figure('Renderer','painters');
% set(fig11, 'Units', 'normalized', 'Position', [0.001, 0.001,0.25, 0.35]);
% plot(mnuSq,eta,'LineWidth',2);
% hold on;
% plot(ScanPoints,Sensitivities,'LineWidth',2);
% xlabel('m_\nu^2 (eV^2)');
% ylabel('\eta (90% C.L.)');
% legend('KRN1 MTD','Optimized MTD','box','off');
% PrettyFigureFormat;
% hold off;
% 
% load('./RelicNuBkg/SensVsmnuSq_KNM1_[0_4]_T.mat');
% fig12=figure('Renderer','painters');
% set(fig12, 'Units', 'normalized', 'Position', [0.001, 0.001,0.25, 0.35]);
% plot(mnuSq,eta,'LineWidth',2);
% hold on;
% plot(ScanPoints,Sensitivities,'LineWidth',2);
% xlabel('m_\nu^2 (eV^2)');
% ylabel('\eta (90% C.L.)');
% legend('Molecular tritium','Atomic tritium','box','off');
% PrettyFigureFormat;
% hold off;
% 
% MTD1=importdata('DR50.mat');
% MTD2=importdata('DR10_Relic.mat');
% fig13=figure('Renderer','painters');
% set(fig13, 'Units', 'normalized', 'Position', [0.001, 0.001,0.5, 0.35]);
% bar(MTD1.qU-18575,MTD1.qUfrac);
% hold on;
% bar(MTD2.qU-18575,MTD2.qUfrac,'FaceAlpha',0.7);
% xlim([-20 50]);
% xlabel('qU-E_0 (eV)');
% ylabel('Time fraction');
% legend('Design MTD','Proposed optimization','box','off');
% annotation('line',[0.333 0.333],[0.2 0.9],'LineWidth',2,'LineStyle','--');
% annotation('line',[0.3545 0.3545],[0.2 0.9],'LineWidth',2,'LineStyle','--');
% PrettyFigureFormat;
% hold off;
% 
fig14=figure('Renderer','painters');
set(fig14, 'Units', 'normalized', 'Position', [0.001, 0.001,0.45, 0.6]);
load('./RelicNuBkg/Chi2Scans/RelicChi2Scan_Twin_BiasmnuSq0_SystON_range40_KNM2_Prompt_2D_Real.mat');
hold on;
[q,t]=contour(mnuScanPoints,etaScanPoints,(Chi2-min(min(Chi2))).',[0 4.61]);
t.LineWidth = 2;
[r,u]=contour(mnuScanPoints,etaScanPoints,(Chi2-min(min(Chi2))).',[0 5.99]);
u.LineWidth = 2;
[s,v]=contour(mnuScanPoints,etaScanPoints,(Chi2-min(min(Chi2))).',[0 9.21]);
v.LineWidth = 2;
v.Color=[0 0.8 0.8];
[~,w]=contour(mnuScanPoints(15:end),etaScanPoints,(Chi2(15:end,:)-min(min(Chi2))).',[0 9.21]);
w.LineWidth=4;
w.Color=[0 0.5 0.5];
ylabel('\eta','FontSize',12);
xlabel('m_{\nu}^{2} (eV^{2})','FontSize',12);
zlabel('\Delta\chi^2','FontSize',12);
text(0.25,0.45e11,'90% C.L.','FontSize',14,'Rotation',12);
text(0.25,0.6e11,'95% C.L.','FontSize',14,'Rotation',12);
text(0.25,0.9e11,'99% C.L.','FontSize',14,'Rotation',12);
xlim([-0.9,1]);
ylim([-1e11,1.5e11]);
s(1,44)=-2;%r(1,17)=-2;q(1,17)=-2;s(2,32)=-2e11;s(1,1)=3;s(2,1)=-8e11;
j=fill(s(1,:),s(2,:),[0 0.5 0.5],'FaceAlpha',0.2);
i=fill(r(1,2:end),r(2,2:end),[0 1 1],'FaceAlpha',0.2);
h=fill(q(1,2:end),q(2,2:end),[50 148 216]/255,'FaceAlpha',0.2);
a=annotation('rectangle',[0.13 0.13 0.368 0.795],'FaceColor','magenta','FaceAlpha',.2);
b=annotation('rectangle',[0.4975 0.13 0.409 0.32],'FaceColor','magenta','FaceAlpha',.2);
text(-0.8,4.5e11,{'Unphysical','neutrino mass'},'FontSize',20,'Color','red','Rotation',-30);
text(-0.3,-9.4e10,'X','FontWeight','bold','FontSize',16,'Rotation',90);
d=annotation('textarrow',[0.52 0.38],[0.35 0.16],'String','Global best fit');
d.FontSize=16;
PrettyFigureFormat;
hold off;

% fig15=figure('Renderer','painters');
% set(fig15, 'Units', 'normalized', 'Position', [0.001, 0.001,0.35, 0.45]);
% load('./RelicNuBkg/UpperLimits/EtaFit_mNu0_2_SystON_DataTypeRealSinglemnuSq_TwinBias_mnuSq0_E0 Norm Bkg etaDeltaChi2_1.mat');
% eta90=eta;
% etaFit90=etaFit;
% load('./RelicNuBkg/UpperLimits/EtaFit_mNu0_2_SystON_DataTypeRealSinglemnuSq_TwinBias_mnuSq0_E0 Norm Bkg etaDeltaChi2_4.mat');
% eta95=eta;
% etaFit95=etaFit;
% load('./RelicNuBkg/UpperLimits/EtaFit_mNu0_2_SystON_DataTypeRealSinglemnuSq_TwinBias_mnuSq0_E0 Norm Bkg etaDeltaChi2_9.mat');
% hold on;
% [~,b] = boundedline(sqrt(mNu),etaFit90,eta90,'cmap',[0 0.75 0.75]);
% [~,d] = boundedline(sqrt(mNu),etaFit95,eta95,'cmap',[0 0.5 0.5],'alpha');
% [~,f] = boundedline(sqrt(mNu),etaFit,eta,'cmap',[0 0.25 0.25],'alpha');
% text(0.1,-4e10,'1\sigma C.L.','FontSize',14);
% text(0.1,1e10,'2\sigma C.L.','FontSize',14);
% text(0.1,5e10,'3\sigma C.L.','FontSize',14);
% ylim([-6.3e10 1.75e11]);
% xlim([0 1]);
% xlabel('m_{\nu} (eV)');
% ylabel('\eta');
% a=annotation('textarrow',[0.6 0.7],[0.4 0.32],'String','\eta best fit');
% a.FontSize=16;
% b=annotation('line',[0.12 0.9],[0.36 0.36]);
% b.LineStyle='--';
% b.LineWidth = 2;
% PrettyFigureFormat;
% hold off;

if strcmp(saveplot,'ON')
    SaveDir = [getenv('SamakPath'),sprintf('RelicNuBkg/Plots/FinalPlots/')];
    MakeDir(SaveDir);
    SaveName1  = 'SensitivityLimitComparison.png';
    SaveNamea  = 'SensitivityLimitComparison1a.png';
    SaveName2  = 'ExcitedStates_SoverB.pdf';
    SaveName3  = 'CnuB_DiffSpec.pdf';
    SaveName4  = 'FSDeffects.pdf';
    SaveName5  = 'TwinRaster.pdf';
    SaveName6  = 'Twin2D.pdf';
    SaveName7  = 'DataRaster.pdf';
    SaveName8  = 'Data2D.pdf';
    SaveName9  = 'Chi2Profile.pdf';
    SaveName10 = 'OptimizedMTD.pdf';
    SaveName11 = 'MTDlimits.pdf';
    SaveName12 = 'AtomicLimits.pdf';
    SaveName13 = 'TDR_MTD.pdf';
    SaveName14 = 'KRN2.pdf';
    SaveName15 = 'Raster2.pdf';
    export_fig(fig2, [SaveDir,SaveName2]);
    export_fig(fig3, [SaveDir,SaveName3]);
    export_fig(fig4, [SaveDir,SaveName4]);
    export_fig(fig5, [SaveDir,SaveName5]);
    export_fig(fig6, [SaveDir,SaveName6]);
    export_fig(fig7, [SaveDir,SaveName7]);
    export_fig(fig8, [SaveDir,SaveName8]);
    export_fig(fig9, [SaveDir,SaveName9]);
    export_fig(fig10,[SaveDir,SaveName10]);
    export_fig(fig11,[SaveDir,SaveName11]);
    export_fig(fig12,[SaveDir,SaveName12]);
    export_fig(fig13,[SaveDir,SaveName13]);
    export_fig(fig14,[SaveDir,SaveName14]);
    export_fig(fig15,[SaveDir,SaveName15]);
    export_fig(fig1, [SaveDir,SaveName1],'-m2');
    export_fig(fig1a,[SaveDir,SaveNamea],'-m2');
end