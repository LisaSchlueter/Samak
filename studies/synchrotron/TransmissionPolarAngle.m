%
% Stefan Groh, PhD
% P204
% Equation 6.22
% 

% Synchrotron - Middle WGTS
ThetaTR =  [0   0.0043633   0.0087266     0.01309    0.017453    0.021817     0.02618    0.030543    0.034907     0.03927    0.043633    0.047997     0.05236    0.056723    0.061087     0.06545    0.069813    0.074176     0.07854    0.082903    0.087266     0.09163    0.095993     0.10036     0.10472     0.10908     0.11345     0.11781     0.12217     0.12654      0.1309     0.13526     0.13963     0.14399     0.14835     0.15272     0.15708     0.16144     0.16581     0.17017     0.17453      0.1789     0.18326     0.18762     0.19199     0.19635     0.20071     0.20508     0.20944      0.2138     0.21817     0.22253     0.22689     0.23126     0.23562     0.23998     0.24435     0.24871     0.25307     0.25744      0.2618     0.26616     0.27053     0.27489     0.27925     0.28362     0.28798     0.29234     0.29671     0.30107     0.30543      0.3098     0.31416     0.31852     0.32289     0.32725     0.33161     0.33598     0.34034      0.3447     0.34907     0.35343     0.35779     0.36216     0.36652     0.37088     0.37525     0.37961     0.38397     0.38834      0.3927     0.39706     0.40143     0.40579     0.41015     0.41452     0.41888     0.42324     0.42761     0.43197     0.43633      0.4407     0.44506     0.44942     0.45379     0.45815     0.46251     0.46688     0.47124      0.4756     0.47997     0.48433     0.48869     0.49306     0.49742     0.50178     0.50615     0.51051     0.51487     0.51924      0.5236     0.52796     0.53233     0.53669     0.54105     0.54542     0.54978     0.55414     0.55851     0.56287     0.56723      0.5716     0.57596     0.58032     0.58469     0.58905     0.59341     0.59778     0.60214      0.6065     0.61087     0.61523     0.61959     0.62396     0.62832     0.63268     0.63705     0.64141     0.64577     0.65014      0.6545     0.65886     0.66323     0.66759     0.67195     0.67632     0.68068     0.68504     0.68941     0.69377     0.69813      0.7025     0.70686     0.71122     0.71558     0.71995     0.72431     0.72867     0.73304      0.7374     0.74176     0.74613     0.75049     0.75485     0.75922     0.76358     0.76794     0.77231     0.77667     0.78103      0.7854     0.78976     0.79412     0.79849     0.80285     0.80721     0.81158     0.81594      0.8203     0.82467     0.82903     0.83339     0.83776     0.84212     0.84648     0.85085     0.85521     0.85957     0.86394      0.8683     0.87266     0.87703     0.88139     0.88575     0.89012     0.89448     0.89884     0.90321     0.90757     0.91193      0.9163];
DEsynT  =  [0  3.8458e-07  1.5384e-06  3.4614e-06  6.1539e-06  9.6161e-06  1.3848e-05  1.8851e-05  2.4623e-05  3.1167e-05  3.8483e-05  4.6571e-05  5.5431e-05  6.5066e-05  7.5474e-05  8.6657e-05  9.8617e-05  0.00011135  0.00012487  0.00013916  0.00015423  0.00017009  0.00018672  0.00020414  0.00022235  0.00024134  0.00026112   0.0002817  0.00030306  0.00032521  0.00034816  0.00037191  0.00039646  0.00042181  0.00044796  0.00047491  0.00050268  0.00053125  0.00056064  0.00059084  0.00062186   0.0006537  0.00068636  0.00071984  0.00075416  0.00078931  0.00082529  0.00086211  0.00089977  0.00093828  0.00097763   0.0010178   0.0010589   0.0011008   0.0011436   0.0011873   0.0012318   0.0012772   0.0013235   0.0013706   0.0014187   0.0014676   0.0015175   0.0015682   0.0016199   0.0016725    0.001726   0.0017804   0.0018358   0.0018921   0.0019493   0.0020075   0.0020666   0.0021267   0.0021878   0.0022499   0.0023129   0.0023769   0.0024419    0.002508    0.002575   0.0026431   0.0027122   0.0027823   0.0028535   0.0029258   0.0029991   0.0030734   0.0031489   0.0032255   0.0033032    0.003382   0.0034619   0.0035429   0.0036252   0.0037085   0.0037931   0.0038788   0.0039658   0.0040539   0.0041433   0.0042339   0.0043258    0.004419   0.0045134   0.0046092   0.0047063   0.0048047   0.0049045   0.0050056   0.0051081   0.0052121   0.0053175   0.0054243   0.0055326   0.0056424   0.0057537   0.0058666    0.005981   0.0060971   0.0062147    0.006334   0.0064549   0.0065776    0.006702   0.0068281   0.0069561   0.0070858   0.0072174    0.007351   0.0074864   0.0076238   0.0077633   0.0079048   0.0080483    0.008194    0.008342   0.0084921   0.0086445   0.0087993   0.0089564    0.009116   0.0092781   0.0094428   0.0096101   0.0097802    0.009953    0.010129    0.010307    0.010489    0.010673    0.010861    0.011052    0.011247    0.011445    0.011647    0.011852    0.012061    0.012274    0.012491    0.012713    0.012939    0.013169    0.013404    0.013644    0.013889     0.01414    0.014396    0.014658    0.014925    0.015199     0.01548    0.015768    0.016062    0.016365    0.016675    0.016994    0.017322    0.017659    0.018005    0.018363    0.018732    0.019112    0.019505    0.019912    0.020333     0.02077    0.021223    0.021695    0.022187    0.022699    0.023236    0.023798    0.024388     0.02501    0.025667    0.026363    0.027103    0.027894    0.028743    0.029659    0.030655    0.031746    0.032953    0.034303    0.035838    0.037616    0.039735    0.042364    0.045858    0.051256];
DEsyn   = @(angleRad) interp1(ThetaTR,DEsynT,angleRad);

Bm = 4.23;
Bs = 2.52;
Ba = 6.3e-4;
gammaFacApprox = 1.018;
qU = 18575;

% Width of TF
DeMax = Ba/Bm*qU*gammaFacApprox;
Es = 18575+[0:0.1:DeMax];

% Iteration 1
ThetaTR_1 = asin(sqrt((Es-qU-DEsyn(0))./Es*Bs/Ba*gammaFacApprox));
DEsyn(ThetaTR_1)*1e3
ThetaTR_2 = asin(sqrt((Es-qU-DEsyn(ThetaTR_1))./Es*Bs/Ba*gammaFacApprox));
DEsyn(ThetaTR_2)*1e3
ThetaTR_3 = asin(sqrt((Es-qU-DEsyn(ThetaTR_2))./Es*Bs/Ba*gammaFacApprox));
DEsyn(ThetaTR_3)*1e3
ThetaTR_4 = asin(sqrt((Es-qU-DEsyn(ThetaTR_3))./Es*Bs/Ba*gammaFacApprox));
DEsyn(ThetaTR_4)*1e3

